<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ws</title>
    <style>
    #main{
        background: #eee;
        border: 1px solid #000;
        border-radius: 4px;
        height: 500px;
        overflow: scroll
    }
        .b{
            padding: 3px;
            background: yellowgreen;
            margin: 3px;
            display: inline-block;
        }
    </style>
    <script src="js/socket.io.dev.js"></script>
</head>

<body>
<h3>欢迎加入聊天室！</h3>
<p>给自己取个昵称：<input type="text" id="a"  /> <button onclick="a()"> 确定</button></p>
<div id="main">

</div>
<div>
    <input type="text" id="c" ><button onclick="sub()">提交</button>
</div>
</body>

<script>
    // 使用socket.io
    var socket=null
    function a() {
        socket = io()
        socket.on('connect',function () {
            console.log(socket.id);
        })
        socket.on('msg',function (v) {
            let newp = document.createElement('span')
            newp.innerText = v
            newp.className = 'b'
            document.getElementById('main').appendChild(newp)

            let newb = document.createElement('br')
            document.getElementById('main').appendChild(newb)
        })
        socket.on('welcome',function (v) {
            console.log(v)
        })
        socket.on('news',function (v) {
            console.log(v)

        })
        socket.on('hello',function (v) {
            console.log(v)
            let newp = document.createElement('span')
            newp.innerText = v
            newp.className = 'b'
            document.getElementById('main').appendChild(newp)

            let newb = document.createElement('br')
            document.getElementById('main').appendChild(newb)
        })

    }
    function sub() {
        console.log('sub',document.getElementById('c').value)
        socket.emit('sendmsg',document.getElementById('c').value )
    }






//    if (window.WebSocket) {
//        let ws = new WebSocket('ws://192.168.0.69:3000/wsaddr')
//
//        // onopen
//        ws.onopen = function () {
//            // Web Socket 已连接上，使用 send() 方法发送数据
//            ws.send("一些数据");
//            alert("数据发送中...");
//        };
//
//        // onmessage
//        ws.onmessage = function (evt) {
//            let received_msg = evt.data;
//            console.log(received_msg)
//            alert("数据已接收...");
//        };
//
//        // onclose
//        ws.onclose = function () {
//            // 关闭 websocket
//            alert("连接已关闭...");
//        };
//    } else {
//        alert("不支持ws")
//    }
</script>

</html>